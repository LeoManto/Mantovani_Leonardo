<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
	body {
		margin-left: 30px;
		margin-right: 30px;
	}

	;

	P {
		font-family: Tahoma;
		font-size: 10pt;
	}

	;

	a,
	a:visited,
	a:active,
	a:link,
	a:hover {
		text-decoration: underline;
		color: #545454;
		background-color: transparent;
		font-size: 93%;
	}

	a:hover {
		background-color: #cccccc;
	}


	hr {
		clear: both;
		height: 1px;
		color: #242424;
		background-color: transparent;
	}

	h1,
	h2,
	h3 {
		color: #242424;
		clear: left;
		font: 100% Tahoma, Helvetica, Arial, sans-serif;
		margin-bottom: 0.5em;
		padding-top: 0.5em;
		border-radius: 10px;
		padding: 5px;
	}

	top {
		width: 100%;
	}


	#i {
		color: #ff1010;
	}

	tt {
		font-family: "Arial";
		font-size: 90%;
		color: #006600;
	}

	em {
		font-family: "Arial";
		font-size: 80%;
		font-weight: bold;
		border-style: solid;
		border-color: #abe876;
		color: #1632cc;
	}

	bc {
		font-family: "Arial";
		font-size: 90%;
		font-weight: bold;
		color: #990000;
		background-color: #fcf8c7;
	}

	ks {
		font-family: "Arial";
		font-weight: bold;
		color: #0000CD;
		font-size: 90%;
	}

	kc {
		font-family: "Arial";
		font-weight: bold;
		color: #008000;
		font-size: 90%;
	}

	pre {
		font-family: "Consolas";
		font-size: 85%;
		background-color: #f5f5f5;
		border: 1.5px solid silver;
		padding: 5px;
	}

	m {
		font-family: "Helvetica";
		line-height: 100%;
		font-size: 75%;
	}

	div.body {

		font-size: 18px;
	}

	k {
		color: #990000;
		font-weight: bold;
		font-size: 90%;
	}

	h1 {
		font-size: 150%;
		background-color: #b2c0ff;
		padding: 10px;
	}

	h2 {
		background-color: #9ed8ff;
		font-size: 130%;
	}

	h3 {
		background-color: #e6ccff;
		font-size: 100%;
	}

	h4 {
		background-color: #ccffcc;
		font-size: 100%;
		width: 95%;
		border-radius: 5px;
		padding: 2px;
	}

	h5 {
		background-color: #d5ffb0;
		font-size: 100%;

	}

	div.req {
		background-color: #d9ffb3;
		font-size: 18px;
		width: 700px;
		border: 3px solid green;
		padding: 15px;
		margin: 10px;
	}

	div.remark {
		background-color: #E3F2FD;
		border: 1.5px solid #d5f2ed;
		padding: 15px;
		margin: 10px;
		border-radius: 25px;
	}
	
	div.remark2 {
		background-color: #F5F5DC;
		border: 1.5px solid #d5f2ed;
		padding: 15px;
		margin: 10px;
		border-radius: 25px;
	}

	table,
	th,
	td {
		border: 1px solid black;
		border-collapse: collapse;
	}

	ol,
	ul,
	li {
		margin: 0;
		margin-left: 10px;
		padding: 0;
		padding-bottom: 5px;
	}

	table,
	th,
	td {
		border: 1px solid black;
	}

	img {
		border: 1.5px solid #d5f2ed
	}

	a,
	a:visited,
	a:active,
	a:link,
	a:hover {
		text-decoration: underline;
		color: #545454;
		background-color: transparent;
	}

	div.wrapdesc {
		width: 90%;
		margin: auto;
	}

	div.imagedesc {
		width: 85%;
		margin: auto;
	}
</style>

<head>

	<title>AutomatedCarParking</title>
</head>

<body>
	<div id="top">
		<h1>
			<font size="5">Automated Car-Parking</font>
		</h1>
	</div>

	<div class="body">
		<h2><a name="introduction"></a>Introduction - SPRINT 1</h2>
		<div class="remark">
			<p>This document contain the analisis of the first SPRINT. To propose first prototype as soon as possible,
				there will be some simplification compared to original problem.
				Simplifications don't concern requirements, which will instead be analyzed in depth right away.
			</p>
		</div>

		<h2>Requirements</h2>
		<div class="remark">
			<p>The requirements below are token from the file <a href="../../../utils/TFBO21ParkingISS.pdf">TFBO21ParkingISS</a></p>
			
			A company intends to build an <i>automating parking service</i> composed of a set of elements:

			<ul>
				<li>A software system, named <em>ParkManagerService</em>, that implements the required automation
					functions.
				</li>
				<li>A <tt>DDR</tt> robot working as a <em>transport trolley</em>, that is intially situated in its
					<em>home</em> location.
					The <tt>transport trolley</tt> has the form of a square of side length <em>RD</em>.
				</li>
				<li>A <em>parking-area</em> is an empty room that includes;
					<ul>
						<li>an <em>INDOOR</em> to enter the car in the area. Facing the <tt>INDOOR</tt>, there is
							a <em>INDOOR-area</em> equipped with a <em>weightsensor</em> that measures the
							<em>weight</em>
							of the car;</li>
						<li>an <em>OUTDOOR</em> to exit from the <tt>parking-area</tt>. Just after the <tt>OUTDOOR</tt>,
							there is
							<em>OUTDOOR-area</em> equipped with a <em>outsonar</em>, used to detect the presence of a
							car.
							The <tt>OUTDOOR-area</tt>, once engaded by a car, should be freed within a prefixed interval
							of
							time <em>DTFREE</em>; </li>
						<li>a number <tt>N (N=6)</tt> of <em>parking-slots</em>;</li>
						<li>a <em>thermometer</em> that measures the temperature <em>TA</em> of the area;</li>
						<li>a <em>fan</em> that should be activated when <k>TA > TMAX</k>, where <em>TMAX</em> is a
							prefixed
							value (e.g. <tt>35</tt>)</li>
					</ul>
					A <em>map</em> of the parking area, represented as a grid of squares of side length <em>RD</em>,
					is available in the file <a href="parkingMap.txt" target="code">parkingMap.txt</a>:
					<pre>
|r, 0, 0, 0, 0, 0, 0, X, 
|0, 0, <bc>X, X,</bc>  0, 0, 0, X, 
|0, 0, <bc>X, X,</bc>  0, 0, 0, X, 
|0, 0, <bc>X, X,</bc>  0, 0, 0, X, 
|0, 0, 0, 0, 0, 0, 0, X, 
|X, X, X, X, X, X, X, X, </pre>
					The map includes the positions of the <tt>parking-slots</tt> (marked above with the symbol <k>X</k>)
					and of the <em>fixed obstacles</em> in the area (the walls marked with the symbol <b>X</b>).
					<br /><br />
					The area marked with <k>X</k> is a sort of 'equipped area' upon which the <tt>transport trolley</tt>
					cannot walk.
					Thus, to get the car in the <tt>parking-slot</tt>
					<ks>(2,2)</ks>, the <tt>transport trolley</tt> must
					go in cell <ks>(1,2)</ks>.
					<br /><br />

					The proper scene for the WEnv is reported in: <a href="parkingAreaConfig.js"
						target="code">parkingAreaConfig.js</a>


					<center><img src="./img/parkingAreaZone.PNG" alt="parkingAreaZone.PNG" width="45%" height="32%" />
					</center>
				</li>
				<li>a <em>parking-manager</em> (an human being) which supervises the state of the <tt>parking-area</tt>
					and handles critical situations
					<!-- by using a software system named <em>ParkMonitoringService</em> -->. </li>
			</ul>

			<div class="remark">
				The job of our company is to design, build and deploy the <em>ParkManagerService</em>.
			</div>
			<!-- and the <em>ParkMonitoringService</em>.-->
			The <tt>ParkManagerService</tt> should create the <tt>ParkServiceGUI</tt> (for the client)
			and the <tt>ParkServiceStatusGUI</tt> (for the manager) and then perform the following tasks:


			<ul>

				<li>
					<hr />
					<em>acceptIN</em>: accept the request of a client to park the car if there is at least one
					<tt>parking-slot</tt> available,
					select a free slot identified with a unique <tt>SLOTNUM</tt>.<br />
					A request of this type can be elaborated only when the <k><tt>INDOOR-area</tt> is free</k>,
					and the <tt>transport trolley</tt> is at <tt>home</tt> or working (<k>not stopped</k> by the
					manager).
					If the <tt>INDOOR-area</tt> is already engaged by a car, the request is not immediately processed
					(the client could simply wait or could - optionally - receive a proper notice).
					<br />
				<li><em>informIN</em>: inform the client about the value of the <tt>SLOTNUM</tt>.</li>
				If <k>SLOTNUM>0</k>:
				<ol>
					<li><em>moveToIn</em>: move the <tt>transport trolley</tt> from its current localtion to the
						<tt>INDOOR</tt> ;</li>
					<li><em>receipt</em>: send to the client a receipt including the value of the <tt>TOKENID</tt> ;
					</li>
					<li><em>moveToSlotIn</em>: move the <tt>transport trolley</tt> from the <tt>INDOOR</tt> to the
						selected
						<tt>parking-slot</tt>;</li>
					<!-- <li>accept another request (<tt>acceptIN</tt> or <tt>acceptOUT</tt>). -->
					<li><em>backToHome</em>: if no other request is present, move the <tt>transport trolley</tt> to its
						<tt>home</tt> location,
						else <em>acceptIN</em> or <em>acceptOUT</em>.</li>
				</ol>

				If <k>SLOTNUM==0</k>:
				<ul>
					<li><em>moveToHome</em>: if not already at home, move the <tt>transport trolley</tt> to its
						<tt>home</tt> location.</li>
				</ul>

				<li>
					<hr />
					<em>acceptOUT</em>: accept the request of a client to get out the car with <tt>TOKENID</tt>.
					A request of this type can be elaborated only when the <k><tt>OUTDOOR-area</tt> is free</k>
					and the <tt>transport trolley</tt> is at <tt>home</tt> or working (<k>not stopped</k> by the
					manager).
					If the <tt>OUTDOOR-area</tt> is still engaged by a car, the request is not immediately processed
					(the client could simply wait or could - optionally - receive a proper notice).

					<ol>
						<li><em>findSlot</em>: deduce the number of the parking slot (<em>CARSLOTNUM</em>) from the
							<tt>TOKENID</tt>;</li>
						<li><em>moveToSlotOut</em>: move the <tt>transport trolley</tt> from its current localtion to
							the
							<tt>CARSLOTNUM/parking-slot</tt> ;</li>
						<li><em>moveToOut</em>: move the <tt>transport trolley</tt> to the <tt>OUTDOOR</tt> ;</li>
						<li><em>moveToHome</em>: if no other request is present move the <tt>transport trolley</tt> to
							its
							<tt>home</tt> location; <br />
							else <em>acceptIN</em> or <em>acceptOUT</em></li>

					</ol>
				</li>
				<li>
					<hr />
					<em>monitor</em>: update the <tt>ParkServiceStatusGUI</tt> with the required information about the
					state
					of the system.
				</li>

				<li>
					<hr />
					<em>manage</em>: accept the request of the manager to stop/resume the behavior of the <tt>transport
						trolley</tt>.
				</li>

			</ul>
			<h3>User stories</h3>
			As a <bc>client - parking phase</bc> :
			<ul>
				<li>I intend to use a <em>ParkServiceGUI</em> provided by the <tt>ParkManagerService</tt> to notify my
					interest in <i>entering</i>
					my auto in the <tt>parking-area</tt> and to receive as answer the number <em>SLOTNUM</em> of a free
					parking-slot (<tt>1&lt;=SLOTNUM&lt;=6</tt>).
					<tt>SLOTNUM<k>==0</k></tt> means that no free slot is available.

				</li>
				<li>If <tt>SLOTNUM <k>>0</k></tt>, I move my car in front to the <tt>INDOOR</tt>, get out of the car and
					afterwards press a <em>CarEnter</em> button on the
					<em>ParkServiceGUI</em>. Afterwards, the <tt>transport trolley</tt> takes over my car and moves it
					from
					the <tt>INDOOR</tt>
					to the selected <tt>parking-slot</tt>.
					The <tt>ParkServiceGUI</tt> will show to me a receipt that includes a (unique) <em>TOKENID</em>,
					to be used in the <i>car pick up</i> phase.</li>
			</ul>

			As a <bc>client - car pick up phase</bc> :
			<ul>
				<li>I intend to use the <tt>ParkServiceGUI</tt> to submit the request to pick up my car, by sending the
					<tt>TOKENID</tt> previously received. </li>
				<li>Afterwards, the <tt>transport trolley</tt> takes over my car and moves it from its
					<tt>parking-slot</tt>
					to the <tt>OUTDOOR-area</tt>.</li>
				<li>I move the car, so to free the <tt>OUTDOOR-area</tt>.
				</li>
			</ul>

			As a <bc>parking-manager</bc>:
			<ul>
				<li>I intend to use the <em>ParkServiceStatusGUI</em> provided by the <tt>ParkManagerService</tt>
					to observe the <em>current state</em> of the <tt>parking area</tt>, including the value <tt>TA</tt>
					of
					the temperature,
					the state of the <tt>fan</tt> and the state of the <tt>transport trolley</tt> (<k>idle, working or
						stopped</k>).</li>
				<li>I intend to <em>stop</em> the <tt>transport trolley</tt> when <k>TA > TMAX</k>, activate the
					<tt>fan</tt> and
					wait until <k>TA &lt; TMAX</k>. At this time, I stop the <tt>fan</tt> and resume the behavior of the
					<tt>transport trolley</tt>.
					Hopefully, the <b>start/stop</b>
					<ks>of the fan</ks> could also be automated by the <tt>ParkManagerService</tt>,
					while the <b>start/stop</b>
					<ks>of the transport trolley</ks> is always up to me.
				</li>

				<li>I expect that the <tt>ParkManagerService</tt> sends to me an <em>alarm</em> if it detectes that the
					<tt>OUTDOOR-area</tt>
					has not been cleaned within the <tt>DTFREE</tt> interval of time.</li>
			</ul>



			<h4>About the devices</h4>
			All the sensors (<tt>weightsensor</tt>, <tt>outsonar</tt>, <tt>thermometer</tt> ) and the <tt>fan</tt>
			should be
			properly simulated
			by mock-objects or mock-actors.

			<h4>When using a real robot</h4>
			No further requirement.

			<h4>When available a Raspberry and a sonar</h4>
			The <tt>outsonar</tt> could be a real device. We can simulate the presence/absence of a car.

			<h4>When using <k>only</k> the virtual robot or <k>no real sonar</k> available</h4>
			Consider the new requirement:
			<ul>
				<li>
					<ks>authorize</ks>: allow a manager to use the <tt>ParkServiceStatusGUI</tt> only if she/he owns
					<bc>
						proper permissions</bc>.
				</li>

			</ul>
		</div>
		<h2>Requirement analysis</h2>
		<div class="remark">
			<h3>Meanings analysis</h3>
			<p>After interviewing client, meanings he associates with nouns have been clarified:</p>
			<ul>
				<li>
					<ks>WeightSensor: </ks> is a sensor that provides weight of a car when it is located in the
					INDOOR-area.
					<!--Initially this sensor has the purpose of signaling the presence of a car in the entrance area.-->
				</li>
				<li>
					<ks>OutSonar: </ks>is a sensor that provide a signal if a car is located in the OUTDOOR-area.
					Initially this sensor has the purpose of signaling the presence of a car in the OUTDOOR-area.
					This component can be equipped with an internal timer, that signals if a car remains in the OUTDOOR-area
					longer than a certain threshold.
				</li>
				<li>
					<ks>Thermometer: </ks> is a sensor that measures temperature of the environment.
				</li>
				<li>
					<ks>ParkServiceGUI: </ks>this is the GUI associated with Clients. It allows clients to request access to the 
					car park and to park their car. Through this GUI clients can receive, from the system, some informations, that are necessary for 
					parking operations, such as the parking-slot assigned to them and the corresponding TOKENID.
					This GUI permits the clients to make request to pickup thei car, providing their TOKENID.
				</li>
				<li>
					<ks>ParkServiceStatusGUI: </ks>this is the GUI associated with ParkingManager. It provides all the
					tools concerning parking area management and various information on the status of the parking area and its components.
				</li>
				<li>
					<ks>Transport Trolley: </ks> is a DDR robot that has the task of parking cars from INDOOR to an
					assigned park-slot and, on a withdraw request, of moving cars from park-slot to OUTDOOR.
					Trolley have three operative state: <k>idle</k>, <k>working</k>, <k>stopped</k>.
					<ul>
						<li>
							When he is in <k>idle</k> state, means that he don't has any request to serve. In this case
							he returns to his main place (<k>HOME</k>).
						</li>
						<li>
							When he is in <k>working</k> state, means that he has to serve (or is serving) a request.
						</li>
						<li>
							When he is in <k>stopped</k> state, means that there are some problems in the environment
							and the <ks>Parking Manager</ks> has manually stopped the trolley work.
							When he is in this situation, Trolley immediately stops whatever type of work it is doing
							and stays where he is.
						</li>
					</ul>
				</li>
				<li>
					<ks>Home: </ks>trolley's main parking area. At application start and when there are no work,
					this is tha place in where trolley wait. It is situated in the north-west corner of room,
					coordinates
					(0,0).
					<!--*REVIEW Anche quando scatta l'allarme e viene messo in attesa? Oppure resta nel punto in cui si trova in quel momento?-->
				</li>
				<li>
					<ks>TOKENID: </ks> is the <k>UNIQUE</k> an identification number of the parking operation, strictly
					associated with the client owner of the parked car.
					This number will be used at the end when the client decides to pickup his car from the parking-area.
				</li>

			</ul>

			<p>Regarding to actions (verbs):</p>
			<ul>
				<li>
					When a client notify system that he wants to enter in the parking-area, receive an answer containing
					the slot number assigned to him, whether they are <k>0</k> or <k>>0</k>.
					His request will be processed when the <k>INDOOR</k> area is free.
				</li>
				<li>
					When a client make request for withdraw his car from parking-area have to enter manually his <k>
						TOKENID</k> on ParkServiceGUI.
				</li>
			</ul>
			<h3> Components Analysis </h3>
			<ul>
				<li>
					<k>trolley:</k> is a virtual robot that can move in the environment (virtual parking-area). The
					customer will provide us with this software component, called <kc>ActorBasicRobot</kc>.
				<li>
					<k>map:</k> is a representation of the parking-area map. We are already in possession of this
					software component, it was developed previously in the project <kc>it.unibo.kotlinSupports.</kc>
				<li>
					<k>parking-slot:</k> each parking slot is identified as a tuple of values (eg. <i>(3,2)</i>)
					indicating the position of the parking spaces in the map.
				<li>
					<k>weightsensor:</k> is a component that is not provided by the customer, so it will be simulated.
				<li>
					<k>outsonar: </k> is a component that may be simulated by a software or implemented by a C library
					called <ks>SonarAlone.c</ks> provided by customer and handled by a kotlin class called <ks>
						sonarHCSR04Support2021.kt</ks>
				<li>
					<k>thermometer:</k> it's not provided by the customer, so it will be a simulated sensor of temperature. 
				<li>
					<k>fan:</k> is a component that simulates the operation of a fan, i.e. it reduces the temperature 
					of the room when it is activated.
			</ul>


		</div>
		<h2>Problem analysis</h2>
		<div class="remark">
			<p>As mentioned in the <a href="#introduction">Introduction</a> for the first SPRINT, in this document we
				will analyze a simplified
				verision of the problem to provide a prototype in a short time.</p>
			<p>
				<h3>Assumptions</h3>
				In this version are applied the simplifications below:
				<li>no <k>GUI</k> will be implemented (neither for the client nor for the parking-manager);
					<div class="remark2"; >GUIs will not be implemented because, during these early stages of 
					project development, we will only carry out local tests. </div>
				<li>Actions of <k>Parking-Manager</k> will not be performed;
					<div class="remark2">The manager performs its actions through the GUI, as it is not implemented 
					it cannot perform operations either</div>
				<li><k>Thermometer</k> and <k>fan</k> are not considered;
					<div class=remark2>These sensors are not considered because in this phase, we want to consider
					only the component to build a first woking prototype of the parking system as soon possible.
					They will be considered in the next SPRINT.</div>
				<li><k>Outsonar</k> and <k>WeightSensor</k> are components simulated by a software;
					<div class=remark2>These sensors are simulated because they are not yet physically available. 
					It is possible that real <b>outsonar</b> will be used in future SPRINTs.</div>
				<li>We assume that <k>client</k> withdraws his car in time, before the alarm activation;
					<div class=remark2>With this assumption, the timeout alarm will never be emitted.
					At this stage, only "standard" customer behaviour will be taken into account. </div>
				<li>It will be simulated only a client
				<div class=remark2>Only one client is considered, because we only want to consider one iteration of 
				the parking and pickup operations. so as to obtain a first simple model of the system. </div>
				<li>At least a parking slot is always free (SLOTNUM > 0).
				<div class=remark2>This assumption is necessary because, we simply want to model the behaviour of the system in 
				"standard" situation.</div>
				<li>No real commands will be sent to the <k>Trolley</k>, but a delay will be added to simulate parking
					operations;
					<div class="remark2">No real commands are sent to the Trolley, because we are waiting for 
					the customer to provide us (as agreed) with this component and its documentation.</div>

			</p>

			<h3>A First Model</h3>

			<table style="width:50%" border="1">
				<tr>
					<td style="width:20%">
						<br>
						<ks><a href="../src/parkingservice.qak">parkingmanagerservice.qak</a></ks>
						<pre>
						<bc>Parking phase</bc> :
						<ul>
						<li>A simulated <b>client</b> sends a request <tt>reqenter</tt> to notify his interest in entering his car in the <em>parking-area</em>.
						<li><ks>[acceptIN]</ks> we assumed that at least one slot is free, the <em>INDOOR</em> is always free and the robot is not STOPPED.
						<li><ks>[informIN]</ks><b> parkingmanagerservive</b> sends the reply <tt>slotsnum(SLOTNUM)</tt> to <b>client</b>, <em>SLOTNUM</em> will be a random value 
in [1,6] (the case <em>SLOTNUM == 0</em> is not contemplated in this model).
						<li>If <em>SLOTNUM > 0</em>, <b>client</b> moves the car in front of <em>INDOOR</em> and then he press the <em>CARENTER</em> button, so it's sended 
a request <tt>carenter</tt> to <b>parkingmanagerservive</b>.
						<li><b>parkingmanagerservive</b> emits an event <tt>carindoorarrival</tt>, to notify that a car is present in the <em>INDOOR-area</em>.
						<li>The <b>weightsensor</b> perceives <tt>carindoorarrival</tt> and emits a event <tt>weight(CARWEIGHT)</tt>.
						<li><ks>[moveToIn]</ks> it's simulated, with a delay, the movements of <b>Trolley</b> from his current position to <em>INDOOR</em>
						<li><ks>[receipt]</ks> <b>parkingmanagerservive</b> handles <tt>carenter</tt> and reply with <tt>receipt(TOKENID)</tt>.
						<li><ks>[moveToSlotIn]</ks> <b>Trolley</b> moves the car to his assigned slot, there is not a real movements but it's added a delay to simulate it.
						<li><ks>[moveToHome]</ks> there is an another delay to simulated Trolley returns to <em>HOME</em> (in this model there in only a client).
						</ul>
						<bc>Car pick up phase</bc> :
						<ul>
						<li><ks>[acceptOUT]</ks> The simulated <b>client</b> send a dispatch to notify his interest in pickup his car <tt>reqpickup(TOKENID)</tt>.
						<li><ks>[findSlot]</ks> in this model <em>TOKENID</em> is already the number of slot where the car is (<em>CARSLOTNUM</em>).
						<li><ks>[moveToSlotOut]</ks> it's simulated, with a delay, the movements of <b>Trolley</b> from his current position to <em>CARSLOTNUM</em>.
						<li><ks>[moveToOut]</ks> it's simulated the movements of <b>Trolley</b> to <em>OUTDOOR</em>.
						<li><b>parkingmanagerservive</b> emits an event <tt>caroutdoorarrival</tt>, to notify that a car is present in the <em>OUTDOOR-area</em>.
						<li>the <b>ousonar</b> perceives <tt>caroutdoorarrival</tt> and actives itself and its internal timer.
						<li>the timer of <b>outsonar</b> will be cancel when the <b>client</b> emits the event <tt>carwithdrawn</tt>, to notify that a car is left the <em>OUTDOOR-area</em>.
						<li>if timer (set to <tt>DTFREE</tt>) expires, <b>outsonar</b> emits an event <tt>timeout</tt> (which is not yet handled).		
						<li><ks>[moveToHome]</ks> there is an another delay to simulated Trolley returns to <em>HOME</em> (in this model there in only a client).
						</li>
						</ul>
						<bc>Parking-manager</bc>:
						<ul>
						<li>The features related to the <tt>parking manager</tt> and its GUI are not considered for the time being. 
Consequently, neither the thermometer or the fans are considered.
						<li>Any alarm (timeout) emitted by the <b>outsonar</b> is not managed and the <b>Trolley</b> can't be manually started/stopped.
						</ul>	
					</pre>
					</td>
				</tr>
			</table>


			<h3>Logical Architecture</h3>
			<p>
				<table style="width:100%" border="1">
					<tr>
						<td style="width:50%;">
							<p>Our system <tt>ParkingManagerService</tt> it's composed by four <ks>actors</ks> in the same
							context <tt>ctxParkingservice</tt>, everyone of them
								providing a different service.</p>
							<p>Actors that we implement, will be of <ks><a href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2021/blob/main/it.unibo.qakactor/userDocs/LabQakIntro2021.html">QActor</a></ks>
								type.</p>
							<ul>
								<li><b>parkingmanagerservice</b>
								<li><b>client</b>
								<li><b>weightsensor</b> (mock-actor)
								<li><b>outsonar</b> (mock-actor)
							</ul>

						</td>
						<td>
							<!--TODO pensare a come comunicano e quale tipo di messaggi si scambiano i diversi qaktor-->
							<center><img src="./img/ActorsModel.png"></center>

						</td>
					</tr>
					<tr>
						<td>
							<center><ks>parkingmanagerservice: </ks></center>
							<center> <a href="../src/parkingservice.qak">parkingservice.qak: </a></center><br>
							This QActor represents the system. It handles all client's request: <tt>reqenter</tt>, <tt>carenter</tt> and <tt>pickup</tt>.
							It provides the clients the SLOTNUM and the TICKETID. It coordinates the movements of the trolley 
							(in this version they are only simulated with delays). <br>
							This actor also triggers the activation of <tt>weightsensor</tt> and <tt>outsonar</tt>.<br><br>
							<center><b>How sensor activation can be triggered?</b></center>
							<br>
							<tt>weightsensor</tt> and <tt>outsonar</tt> must be triggered when a car is, respectively, in INDOOR and OUTDOOR area.<br>
							<k>parkingmanagerservice</k> is the only component who knows when a car is in INDOOR or OUTDOOR area,
							it can be notify it in two ways:
							<ol>
								<li>sending a <k>dispatch</k> to the sensor when a car is in the right area.
								<li>emitting an <k>event</k>, since the sensor there are in the same context.
							</ol>
							During the analysis phase it can already be observed that the second solution is more appropriate because
							it is independent of the characteristics of the sensors and their quantity and position.
						</td>
						<td>
							<center><ks>client: </ks></center>
							<center> <a href="../src/parkingservice.qak">parkingservice.qak: </a></center><br>
							It's the QActor that sends the requests (<tt>reqenter</tt> and <tt>carenter</tt>) to the system during the parking phase 
							and sends dispatch (<tt>pickup</tt>) during the picking phase.<br>
							It replaces, in this version, the role of the <ks>ParkServiceGUI</ks>, in particular, for the moment, it's simulated the
							operations related to a single client.
							
						</td>
					</tr>
					<tr>
						<td>
							<center><ks>weightsensor: </ks></center>
							<center> <a href="../codedqak/weightsensorSimulator.kt">weightsensorSimulator.kt: </a></center><br>
							This mock-actor generates a random value that represents the
									weight of car in entrance and propagates it by emitting an event <tt>weightsensor</tt>.<br>
									It starts the simulation when perceives the <k>carindoorarrival</k> event.
									<br>
									The purpose of this component is to ensure that a car in actual in INDOOR-area when a client press the
									<tt>carenter</tt> button. Weight simulation takes place only once for each car arrived at INDOOR-area, after
									that weight value is setted to 0.
						</td>
						<td>
							<center><ks>outsonar: </ks></center>
							<center> <a href="../codedqak/sonarSimulator.kt">sonarSimulator.kt: </a></center><br>
							This actor has a boolean variable <k>busy</k>, that indicates if
							the car is present in the outdoor, so as to simulate a real sensor. It start the
							simulation when perceives <k>caroutdoorarrival</k> event. When the simulation stats,
							it's activated also an internal timer. <br>
							This timer performs a countdown from <tt>DTFREE</tt> value, if it arrives to 0 it's
							emitted an event <tt>timeout</tt>.
							The countdown is implemented with a <a href="https://en.wikipedia.org/wiki/Coroutine">Coroutine</a>, 
							called <tt>mainScope</tt> which is cancelled <pre>mainScope.cancel()</pre> when the 
							outsonar detects the <k>carwithdrawn</k> event, indicating that the car has been taken out of the OUTDOOR-area.
						</td>
					</tr>
					<tr>
						<td colspan="2">
							<center><img src="img/logicalArchitecture.png" width="60%"></center>
						</td>
					</tr>
				</table>
			</p>
		</div>
		<!--TODO fare spiegazione logica del programma con linguaggio naturale.-->

		<h2>Test plans</h2>
		<a href="../test/it/unibo/parkingmanagerservicetest/TestPlan0.kt">TestPlan0.kt </a><br>
		<p>
		In this first test plan are considered only <ks>non-distributed</ks> tests.<br>
		<br>
		<p>
      Tests is built using CoapObserver provided by the costumer in the project <ks>it.unibo.qak21.basicrobot</ks> (<a href="../test/it/unibo/parkingmanagerservice/test/utils/CoapObserverForTesting.kt">CoapObserverForTesting.kt</a>).
      <br>
  
		</p>
		<kc>TestPlans0 goals:</kc>
		<ul>
		<li>Ensure that the workflow of the system meets a set of requirements <k><b>(integration testing)</b></k>. <br> <br>
      In this testing plan are employed <tt>parkingmanagerservice</tt> and <tt>client</tt>. In particular, to start system simulation <tt>client</tt> sends a request <tt>reqenter</tt> and the others messages necessary to continue properly the entire workflow. Test is performed observing some significant resouces updated by <tt>parkingmanagerservice</tt> so as to verify the correct functioning of the system.
			<div class=remark2>
			<h3>Parking phase</h3>
				It's tested if the value of <em>SLOTNUM</em> provided by the 
				<b>parkingmanagerservive</b> it's greater than 0 and if <em>TOKENID</em> provided to client it's greater than 0 and equals to 
				<em>SLOTNUM</em> (this requirement is introduced by the assumptions made for sprint 1).
			<h3>Picking phase</h3>
				It's tested if the <em>TOKENID</em> provided by client is greater than 0.
			
		</div>
		<li>Ensure that some components work properly individually. <k><b>(unit testing)</b></k> <br>
     <br>
      Here it's tested the correct behaviour of <tt>weightsensor</tt> and <tt>outsonar</tt>. During this kind of test, like in the <k>integration test</k>, the components updates some resouces whose values are observed and then checked.
		<div class=remark2>
		<h3>Testing the weightsensor</h3>
			It's tested if the value provided by <b>weightsensor</b> when a car is in <em>INDOOR</em> it's greater than 0 
			(indicating the actual presence of the car).
		<h3>Testing the outsonar</h3>
		It's tested if <b>outsonar</b> detects the presence of a car in <em>OUTDOOR</em>.
			(indicating the actual presence of the car).
		
		</div>
		</ul>
	
		</p>
		<!--REVIEW direi nulla di che, semplicemente essendo tutto automatizzato, fare una prova integrale dell'aplicazione, salvarsi ogni indicazione dei suoi 
			comportamenti durante l'esecuzione e vedere se rispetta le regole assegnate-->

		<h2>Project</h2>

		<h2>Deployment</h2>
		The deployment of SPRINT 1 consists in a release on a <a
			href="https://github.com/P-damicis/Automated_Car_Parking/tree/main/sprint_1">Github repository</a>.

		<h2>Maintenance</h2>
		This is the first Sprint, more features will be released in the next (Second) Sprint.
		<br /><br />
	</div>

	<div style="background-color:rgba(42, 7, 241, 1.0); width:100%;text-align:center;color:white">
		<table style="width:100%" border="1">
			<tr>
				By Mantovani Leonardo and Pier Domenico d'Amicis

			</tr>
		</table>
	</div>
</body>

</html>
