<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
	body {
		margin-left: 30px;
		margin-right: 30px;
	}

	;

	P {
		font-family: Tahoma;
		font-size: 10pt;
	}

	;

	a,
	a:visited,
	a:active,
	a:link,
	a:hover {
		text-decoration: underline;
		color: #545454;
		background-color: transparent;
		font-size: 93%;
	}

	a:hover {
		background-color: #cccccc;
	}


	hr {
		clear: both;
		height: 1px;
		color: #242424;
		background-color: transparent;
	}

	h1,
	h2,
	h3 {
		color: #242424;
		clear: left;
		font: 100% Tahoma, Helvetica, Arial, sans-serif;
		margin-bottom: 0.5em;
		padding-top: 0.5em;
		border-radius: 10px;
		padding: 5px;
	}

	top {
		width: 100%;
	}


	#i {
		color: #ff1010;
	}

	tt {
		font-family: "Arial";
		font-size: 90%;
		color: #006600;
	}

	div.remark2 {
		background-color: #F5F5DC;
		border: 1.5px solid #d5f2ed;
		padding: 15px;
		margin: 10px;
		border-radius: 25px;
	}


	em {
		font-family: "Arial";
		font-size: 80%;
		font-weight: bold;
		border-style: solid;
		border-color: #abe876;
		color: #1632cc;
	}

	bc {
		font-family: "Arial";
		font-size: 90%;
		font-weight: bold;
		color: #990000;
		background-color: #fcf8c7;
	}

	ks {
		font-family: "Arial";
		font-weight: bold;
		color: #0000CD;
		font-size: 90%;
	}

	kc {
		font-family: "Arial";
		font-weight: bold;
		color: #008000;
		font-size: 90%;
	}

	pre {
		font-family: "Consolas";
		font-size: 85%;
		background-color: #f5f5f5;
		border: 1.5px solid silver;
		padding: 5px;
	}

	m {
		font-family: "Helvetica";
		line-height: 100%;
		font-size: 75%;
	}

	div.body {

		font-size: 18px;
	}

	k {
		color: #990000;
		font-weight: bold;
		font-size: 90%;
	}

	h1 {
		font-size: 150%;
		background-color: #b2c0ff;
		padding: 10px;
	}

	h2 {
		background-color: #9ed8ff;
		font-size: 130%;
	}

	h3 {
		background-color: #e6ccff;
		font-size: 100%;
	}

	h4 {
		background-color: #ccffcc;
		font-size: 100%;
		width: 95%;
		border-radius: 5px;
		padding: 2px;
	}

	h5 {
		background-color: #faffb0;
		font-size: 100%;
		border-radius: 5px;
		padding: 2px;
		width: 90%;

	}

	div.req {
		background-color: #d9ffb3;
		font-size: 18px;
		width: 700px;
		border: 3px solid green;
		padding: 15px;
		margin: 10px;
	}

	div.remark {
		background-color: #E3F2FD;
		border: 1.5px solid #d5f2ed;
		padding: 15px;
		margin: 10px;
		border-radius: 25px;
	}

	table,
	th,
	td {
		border: 1px solid black;
		border-collapse: collapse;
	}

	ol,
	ul,
	li {
		margin: 0;
		margin-left: 10px;
		padding: 0;
		padding-bottom: 5px;
	}

	table,
	th,
	td {
		border: 1px solid black;
	}

	img {
		border: 1.5px solid #d5f2ed
	}

	a,
	a:visited,
	a:active,
	a:link,
	a:hover {
		text-decoration: underline;
		color: #545454;
		background-color: transparent;
	}

	div.wrapdesc {
		width: 90%;
		margin: auto;
	}

	div.imagedesc {
		width: 85%;
		margin: auto;
	}
</style>

<head>

	<title>AutomatedCarParking</title>
</head>

<body>
	<div id="top">
		<h1>
			<font size="5">Automated Car-Parking</font>
		</h1>
	</div>

	<div class="body">
		<h2><a name="introduction"></a>Introduction - SPRINT 4</h2>
		<div class="remark">
			<p>In this document it will be analysed the fourth and final SPRINT of the project.
				In this phase we will extend previous SPRINT's model, adding the implementation of both Client GUI and
				ParkingManager GUI and of a real Sonar to OUTDOOR.
				The goal of this SPRINT, together with the previous ones, is to describe how and why the various
				components of the system have been implemented.
			</p>
		</div>

		<h2>Problem analysis</h2>
		<div class="remark">
			<p>As mentioned in the <a href="#introduction">Introduction</a> in this SPRINT, we will analyze the system
				during
				the last phase of prototyping. The goal
				version (with less functionality) of the final system.</p>
			<p>
				<h3>Assumptions</h3>

				In this version we define as definitive some assumptions made initially.
				Therefore follow simplified features will characterize also the obtained prototype.
				<br><br>
				<ul>
					<li>
						<k>Thermometer</k> and <k>fan</k> are components simulated by a software.
						<div class=remark2>These components are simulated because they are not yet physically
							available.

					<li>
						<k>WeightSensor</k> is a component simulated by a software;
						<div class=remark2>
							This sensor are simulated because they are not yet physically available.
						</div>

					<li>
						<k>Sonar</k> is a real component, but it could be simulated as needed.
						<div class=remark2>
							it will be simulated for testing purpose, to do they in agile way
						</div>
	
				</ul>
			</p>

			<h3>Model - SPRINT 4</h3>
			<br>
			<table style="width:100%; border:1px solid; font-family: Consolas; background-color:#f5f5f5;">
				<tr>
					<td>
						<center>
							<ks>parkingmanagerservice</ks>
						</center>
					</td>
					<td>
						<center>
							<ks>client</ks>
						</center>
					</td>
				</tr>
				<tr>
					<td colspan=3>
						<center>
							<bc>Parking Phase</bc>
						</center>
					</td>
				</tr>
				<tr>
					<td style="width: 50%">
						<br>
						<ul style="font-family: Consolas; font-size: 15px">
							<li>It checks if there is at least one <tt>parking-slot</tt> available.

							<li>After this check it is determined if <tt>reqenter</tt> can be accepted.

							<li>It's received the request <tt>reqenter</tt> sended by a <b>client</b>.

							<li>
								<ks>[acceptIN]</ks> It's generated <em>SLOTNUM</em> and the related slot is marked as
								occupied.

							<li>
								<ks>[informIN]</ks> If <em>INDOOR-area</em> is <i>FREE</i> and trolley status is not
								<i>STOPPED</i> the request is immediately elaborated sending to <b>client</b> the reply
								<tt>slotsnum : slotsnum ($SLOTNUM)</tt>. Otherwise it's sended to <b>client</b> the
								reply <tt>waitIndoor : slotsnum ($SLOTNUM)</tt>, and so <b>client</b>
								waits until the <em>INDOOR-area</em> become FREE or trolley status is not STOPPED.

							<li>It's received the request <tt>carenter</tt> sended by the <b>client</b>.

							<li><b>parkingmanagerservive</b> emits an event <tt>carindoorarrival</tt>, to notify that
								the client's car is in <em>INDOOR-area</em>.

							<li>
								<ks>[moveToIn]</ks> Commands are sent to the <b>trolley</b> so that it performs the
								movements to go from the current position to <em>INDOOR</em>

							<li>The <b>weightsensor</b> perceives <tt>carindoorarrival</tt>, and emits the event
								<tt>weight(CARWEIGHT)</tt>.

							<li><em>INDOOR</em> is marked as occupied.

							<li> It's expected the event <tt>finished</tt> emitted by <b>trolley</b> at the end of his
								path.

							<li>
								<ks>[receipt]</ks> It's generated the <em>TOKENID</em> related to <em>SLOTNUM</em>
								assigned to <b>client</b> and reply to him with <tt>receipt(TOKENID)</tt>.

							<li>
								<ks>[moveToSlotIn]</ks> If <b>trolley</b> is in <em>INDOOR-area</em>, <b>Trolley</b>
								takes the car and moves it to slot assigned to it.

							<li>When event <tt>finished</tt> is perceived, <em>INDOOR</em> is marked as free.

							<li>
								<ks>[moveToHome]</ks> If for a while no requests are received, commands are sent to the
								<b>trolley</b> for return to <em>HOME</em>.

							<li> If a new request arrives during returnig to <em>HOME</em>, it must be immediately
								handled.
						</ul>

					<td id = "client_parking" style="width: 50%">
						<ul style="font-family: Consolas; font-size: 15px">
							<li><b>client</b> opens <b>clientGUI</b> and clicks on <k>Enter request</k> to notify his interest in
								entering his car in the <em>parking-area</em>. In this way it's sended to <b>parkingmanagerservice</b> a request <tt>reqenter</tt>.
							<li>Then, on <b>clientGui</b>, it's displayed <em>SLOTNUM</em> assigned to him.
							<li>If <em>SLOTNUM > 0</em> and <em>INDOOR-area</em> is FREE, <b>client</b> moves the car in
								front of <em>INDOOR</em> and clicks on <em>CarEnter</em> button, so it's sended the request <tt>carenter</tt> to
								<b>parkingmanagerservive</b>, otherwise	<b>client</b> waits for the <em>INDOOR-area</em> to become FREE.
						</ul>
						
					</td>
				<tr>
					<td colspan=2>
						<center>
							<bc>Car pick up phase</bc>
						</center>
					</td>
				</tr>
				<tr>
					<td style="width: 50%">
						<ul style="font-family: Consolas; font-size: 15px">

							<li>It checks if <em>OUTDOOR</em> is FREE and if trolley status is not STOPPED.

							<li>After the checks it is determined if <tt>pickup</tt> can be elaborated.

							<li>
								<ks>[acceptOUT]</ks> It's received the dispatch <tt>pickup(TOKENID)</tt> sended by a
								<b>client</b>.

							<li>
								<ks>[findSlot]</ks> It's obtained the <em>CARSLOTNUM</em> from <tt>TOKENID</tt> sended
								by <b>client</b>.

							<li>
								<ks>[moveToSlotOut]</ks> Commands are sent to the <b>trolley</b> so that it performs the
								movements to go from the current position to <em>CARSLOTNUM</em>.

							<li>The slot corrisponding to <em>CARSLOTNUM</em> is marked as free.

							<li>
								<ks>[moveToOut]</ks> When it's perceives event <tt>finished</tt> and it's verified that
								<b>trolley</b> is in <em>CARSLOTNUM</em>, are sent commands to the <b>trolley</b>
								so that it performs the movements to go from <em>CARSLOTNUM</em> to <em>OUTDOOR</em>.

							<li><b>outsonar</b> detects the presence of car in <em>OUTDOOR-area</em>.								

							<li><em>OUTDOOR-area</em> status is marked as occupied and the countdown of the <b>timer</b>
								it's actived.

							<li>Countdown will be cancelled when <b>outsonar</b> detects that there is no car in
								<em>OUTDOOR-area</em>.

							<li>If timer (set to <tt>DTFREE</tt>) expires, it's emitted an event
								<tt>timeout</tt>.

							<li>
								<ks>[moveToHome]</ks> If for a while no requests are received, commands are sent to the
								<b>trolley</b> for return to <em>HOME</em>.

							<li> If a new request arrives during returnig to <em>HOME</em>, it must be immediately
								handled.

						</ul>
					</td>

					<td style="width: 50%">
						<ul style="font-family: Consolas; font-size: 15px">
							<li><b>client</b> inserts his <em>TOKENID</em> in the related <i>text box</i>
								and clicks on <k>Submit your TOKENID</k> button. So it's sended a dispatch to <b>parkingmanagerservice</b>
								<tt>pickup(TOKENID)</tt> to notify his interest in in picking his car from parking-area.
							<li>When the car is in <em>OUTDOOR-area</em>, the <b>client</b> takes his car away, in this way <b>outsonar</b> detects
								that.
						</ul>
					</td>
				</tr>
				<tr>
					<td colspan=2>
						<center>
							<bc>Parking-manager</bc>
						</center>
					</td>
				</tr>
				<tr>
					<td colspan=2>
						<ul style="font-family: Consolas; font-size: 15px">
							<li><b>Parking manager</b> opens <b>ManagerGUI</b> where are displayed many informations
								about parking system and parking and picking operations.
							<li>If detected temperature into the parking is over the limit, fan actives itself automatically. 
								While fan is active, <b>Parking Manager</b> can click on <k>STOP trolley</k> button to stop <b>trolley</b>.
							<li>When the temperature comes back below the limits, <b>Parking Manager</b> can click on <k>RESUME trolley</k> to resume it.
							<li>If it's emitted the alarm, caused by a car in <em>OUTDOOR-area</em> after time limit, <b>Parking Manager</b> is advised
								about it on his GUI.
						</ul>
					</td>

				</tr>
			</table>
			<br>
			<div class="remark2">
				In this SPRINT we have implemented the Client and the ParkingManager graphic interface. Therefore a real client can perform request from this GUI
				and a real Manager can supervise the parking status and at the occurrence <k>STOPPING</k> or <k>RESUMING</k> the Trolley work.
				<br>
				<br>
				We have also implemented a real HC-SR04 Sonar which allow to detect the effective presence or absence of a real car during the pickup phase.
			</div>
			 		
			<h4>Client GUI</h4>
			<p>
				A graphical interface is required to allow the customer to make requests to the parking system.
				This GUI will be a service, probably implemented using <a href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2021/blob/main/sonarguispring/userDocs/LabSpringUsageIntro.html"></a>Spring Boot</a>.
				<b>client</b> using this GUI will can:
				<ul>
					<li> forward to system a parking request.
					<li> watch on inteface the value of assigned <em>SLOTNUM</em>
					<li> forward a CarEnter request to notify system that the car is correctly positioning at <em>INDOOR-area</em>.
					<li> watch on display <em>TOKENID</em> received by system.
					<li> insert <em>TOKENID</em> in order to perform pickup request.
				</ul>
				
			</p>
			<h4>Manager GUI</h4>
			<p>
				For ParkingManager is required an interface that shows status of any component that compose our system.  
				This GUI will be a service, probably implemented using <a href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2021/blob/main/sonarguispring/userDocs/LabSpringUsageIntro.html"></a>Spring Boot</a>.
				<br>
				Component that compose the interface of this GUI are:
				<h5>Regarding to Trolley</h5>
				<ul>
					<li><ks>Trolley status</ks>: the status of the Trolley (<k>IDLE</k>, <k>WORKING</k> or <k>STOPPED</k>)
						<ul>
							<li><ks>STOP Trolley</ks>: under certain conditions permit to ParkingManager to manually STOP work of Trolley.
							<li><ks>RESUME Trolley</ks>: under certain conditions permit to ParkingManager to manually RESTART the Trolley. Trolley resumes its work from where it was interrupted.
						</ul>
					<li><ks>Trolley position</ks>: map cordinates of the actual trolley position in the environment.
					<li><ks>Trolley destination</ks>: destination to which the trolley is heading.
					<li><ks>Trolley direction</ks>: direction in which the trolley is moving.
				</ul>

				<h5>Regarding to INDOOR and OUTDOOR</h5>
				<ul>
					<li><ks>INDOOR status</ks>: here is indicated if the INDOOR is <k>FREE</k> or if it is <k>BUSY</k>
					<li><ks>OUTDOOR status</ks>: here is indicated if the OUTDOOR is <k>FREE</k> or if it is <k>BUSY</k>
					<li><ks>Current weight</ks>: show the weight of the car placed on INDOOR
					<li><ks>Alarm status</ks>: show if the alarm is activated or not
				</ul>
				<h5>Regarding to Environment</h5>
				<ul>
					<li><ks>Temperature</ks>: actual environment temperature
					<li><ks>Fan status</ks>: indicates if the Fan is in <k>WORKING</k> status or in <k>STOPPED</k> status.
					<li><ks>Environment Camera</ks>: there is also the possibility to have a camera that show the area of the parking.
				</ul>
			</p>
			<!--stop trolley handling (trolleyStopper qak)-->
			<h4>Real Sonar</h4> 
				At this final stage, we introduce a <b>real sonar</b> in order to perform the tasks previously made by simulated one.<br>
				In particular, this sonar will be mounted on a physical device (e.g.: Raspberry, Arduino or similar) and its goal will be to 
				send to the <b>parkingmanagerservice</b> many and periodical messages containing the value of distance detected.
				<b>sonar</b> will be distributed relative to the rest of the system, so to share the collected informations, we need to adopt a method 
				to send mesages towards a external context, for example it would be possible to use a  <k><a href="https://www.hivemq.com/mqtt-essentials/">MQTT broker</a></k>.
				Regarding the involvement of this device, as mentioned above, we received some components and documentation for its use from the customer.
				

			<h3>Logical Architecture</h3>
			<p>
				<table style="width:100%" border="1">
					<tr>
						<td style="width:50%;">
							<p>Our system <tt>ParkingManagerService</tt> it's composed by eight <ks>actors</ks> in
								the <tt>ctxParkingservice</tt> context and one <ks>actor</ks> in the <tt>ctxsonaronrasp</tt> context. 
								Every <ks>actor</ks> provides a different service or simulating a certain component.
								Two separated <ks>services</ks> that represent the GUIs.
							</p>
							<p>Actors that we implement, will be of <ks><a
										href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2021/blob/main/it.unibo.qakactor/userDocs/LabQakIntro2021.html">QActor</a>
								</ks>
								type.</p>
							<ul>
								<li><tt>ctxParkingservice</tt>
									<ul>
										<li><b>parkingmanagerservice</b>
										<li><b>trolley</b>
										<li><b>sonarhandler</b>
										<li><b>trolleystopper</b>
										<li><b>weightsensor</b> (mock-actor)
										<li><b>outdoortimer</b> (mock-actor initialized only in case of real sonar usage)
										<li><b>thermometer</b> (mock-actor)
										<li><b>fan</b> (mock-actor)
									</ul>
								</li>
								<li><tt>ctxSonaronrasp</tt>
									<ul>
										<li><b>sonar</b>
									</ul>
								</li>
								<li><tt>services</tt>
									<ul>
										<li><b>clientGUI</b>
										<li><b>managerGUI</b>
									</ul>
								</li>
							</ul>

						</td>
						<td>
							<center><img src="./img/actors.png"></center>

						</td>
					</tr>
					<tr>
						<td>
							<center>
								<ks>parkingmanagerservice: </ks>
							</center>
							<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.ParkManagerService_s4/src/parkingservice.qak">parkingservice.qak: </a></center><br>
							This QActor represents the system. It handles, checking also if several conditions are satisfied, and elabotares all client's requests: <tt>reqenter</tt>,
							<tt>carenter</tt> and <tt>pickup</tt>.
							It provides the clients the <em>SLOTNUM</em> and the <em>TOKENID</em>. <br>
							It coordinates the movements of the <b>trolley</b>, sending to it the positions to reach. <br>
							This actor also triggers the activation of:
							<ul>
								<li><tt>weightsensor</tt>, through the event <tt>carindoorarrival</tt>.
								<li><tt>thermometer</tt> by sending a dispatch <tt>startthermometer</tt> to it.
								<li><tt>sonarhandler</tt> by sending a dispatch <tt>startsonar</tt>  to it.
							</ul>
							
						</td>
						<td><center>
							<ks>trolley: </ks>
						</center>
						<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.ParkManagerService_s4/src/parkingservice.qak">parkingservice.qak: </a></center><br>
						This QActor works as an intermediary between the system and the remote virtual robot.<br>
						It can receive from <b>parkingmmanagerservice</b> dispatch <tt>move:move(GOAL)</tt>, where
						<i>GOAL</i> represents the location that must be reached by the Trolley inside the
						environment. <br>
						this actor uses some functions implemented in TrolleySupport.kt to obtain from the GOAL a
						set of moves that the robot must make to reach it.
						In particular, the GOAL is translated into the corresponding pair of coordinates, then they
						are passed as arguments to a method of a class into the package "itunibo.planner"
						inside the library <a
							href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/unibolibs/IssActorKotlinRobotSupport-2.0.jar">
							<ks>IssActorKotlinRobotSupport-2.0.jar</ks>
						</a>, provided by the client.<br>
						From the obtained set of moves, this QActor sends to the robot one command at a time, as
						long as there are still moves to perform.
						The commands of <k>backward</k> and <k>forward</k> are managed in asynchronous way, that is
						after their sending, it waits for a fixed time <tt>StepTime</tt> and after it is sent a
						command of <k>halt</k> to interrupt the move.<br>
						This QActor also handles collisions, <a href="#obstacle">as already explained</a>.
						</td>
					</tr>
					<tr>
						<td colspan=2 style="text-align: center;">
							<center>
								<ks>weightsensor: </ks>
							</center>
							<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.ParkManagerService_s4/codedqak/weightsensorSimulator.kt">weightsensorSimulator.kt: </a>
							</center><br>
							This mock-actor generates a random value that represents the weight of car in entrance and propagates it by emitting an event <tt>weightsensor</tt>.<br>
							This actor has the task of updating <em>INDOOR-area</em> status.<br>
							It starts the simulation when perceives the <k>carindoorarrival</k> event, emitted by
							<b>parkingmanagerservice</b>, as previously mentioned.
							Also at this final stage, this components remains a mock-actor, because a physical device is not yet available.
							This actor has also the task to update some resources about <k>weight</k> and <k>indoorStatus</k>, this updating are
							perceived by <b>ManagerGUI</b>.
						</td>
						
					</tr>
					<tr>
						<td>
							<center>
								<ks>thermometer: </ks>
							</center>
							<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.ParkManagerService_s4/codedqak/thermometerSimulator.kt">thermometerSimulator.kt: </a>
							</center><br>
							This mock-actor is activated immediately, during the initialization of
							<b>parkingmanagerserive</b>. It performs two different tasks:
							<ul>
								<li>emits continuously an event, in which are the current temperature of environment</li>
								<li>
									to cyclically increment the value of temperature, this to simulate the increasing of
									environment temperature during his activity
								</li>
							</ul>
							For it coherence with requirements, we have fixed a constant value
							<k>maxTemp</k> that indicates upper temperature limits of system operation. <br> 
							It's necessary to decide a value that represent the optimal temperature at which fan can be
							stopped, we indicate this with constant value <k>minTemp</k>.
							When temperature has reached the upper limit, <b>fan</b> send to <b>thermometer</b> a dispatch
							message <tt>stopinc</tt>, which has the function of ending temperature increase process.
							On the other hand, when the temperature has returned to the working values, this is
							reported through an event <tt>normtemp</tt> emitted by <b>fan</b>, the process of increasing
							temperature can restart.
							This actor has also the task to update <k>temp</k> resource, this updating is
							perceived by <b>ManagerGUI</b>.
						</td>
						<td>
							<center>
								<ks>fan: </ks>
							</center>
							<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.ParkManagerService_s4/codedqak/fanSimulator.kt">fanSimulator.kt: </a></center><br>
							This mock-actor is strictly related with thermometer actor. It evaluates every
							<tt>temp</tt> event that thermometer emit and check if the temperature of the
							environment
							is under the max prefixed temperature values. If temperature exeed the limits, fan actor
							send a dispatch message <tt>stopinc</tt> to the thermometer; this message is required to
							stop execution of increasing process.<br>
							When fan start his execution, it start to decrease temperature, until this reaches <k>
								minTemp</k>. Then an event is emitted <tt>normtemp</tt> that warns that the
							simulation of increasing temperature can restart and fan actor terminate his work.<br>
							This actor has also the task to update <k>fan</k> resource, which indicates if fan is active or less, this updating is
							perceived by <b>ManagerGUI</b>.
						</td>

					</tr>
					<tr>
						<td>
							<center>
								<ks>trolleystopper: </ks>
							</center>
							<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.ParkManagerService_s4/src/parkingservice.qak">parkingservice.qak: </a></center><br>
							This actor has the goal to stop or resume <b>trolley</b>, forwarding to it a command directly received from ManagerGUI.
						</td>
						<td>
							<center>
								<ks>outdoortimer: </ks>
							</center>
							<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.ParkManagerService_s4/codedqak/outdoorTimer.kt">parkingservice.qak: </a></center><br>
							<p>
							When it's used real sonar, it cannot have a internal timer to manage the countdown, so it's necessary create this mock-actor.
							It has the goal to start the countdown when it receives <tt>starttimer</tt> from <b>sonarhandler</b>. It can stop this countdown when 
							<b>sonarhandler</b> sends it <tt>stoptimer</tt> message.<br>
							If countdown expires before arriving <tt>stoptimer</tt>, it updates <k>alarm</k> resource, this updating is
							perceived by <b>ManagerGUI</b>, who will show an advice on his interface.</p>
						</td>
					</tr>
					<tr>
						<td>
							<center>
								<ks>sonar:</ks>
							</center>
							<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.sonar/src/sonaronrasp.qak">sonaronrasp.qak: </a></center><br>
							<p>
								It's an actor in a different context and on a different device, probably (but not necessary) connected at same network of the system.
								It is the last actor of a pipe, in which every mock.actor has a differt task, like removing wrong data and showing
								in a log the detected measurements.
								This component will use a <k></k>MQTT broker</k> in order to propagate the events (<tt>sonar:distance(V)</tt>) containing values obtained up to <b>sonarhandler</b> actor.
							</p>
						</td>
						<td>
							<center>
								<ks>sonarhandler: </ks>
							</center>
							<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/blob/main/sprint_4/it.unibo.ParkManagerService_s4/src/parkingservice.qak">parkingservice.qak: </a></center><br>
							<p>
								<b>sonarhandler</b> is used only if it's used real sonar.
								It perceives every <tt>sonaroutdoor</tt> event, in which is indicated the distance detected in <em>OUTDOOR</em> area by the sensor. If distance received is under certain limit and the 
								<em>OUTDOOR</em> is still <k>FREE</k>, it has the task to set <em>OUTDOOR</em> status to <k>BUSY</k> and to send a <tt>starttimer</tt> dispatch to <b>outdoortimer</b>.
								If there is a change in a distance received and this value is higher than the limit and <em>OUTDOOR</em> status is still setted to <k>BUSY</k>, then it has the task to send a <tt>stoptimer</tt> dispatch and 
								to set <em>OUTDOOR</em> status to <k>FREE</k>.
							</p>
						</td>
					</tr>
					<tr>
						<td><center>
							<ks>ClientGUI: </ks>
						</center>
						<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/tree/main/sprint_4/ClientGui">ClientGUI: </a></center><br>
						<p>
							It's the graphic interface at client's disposal, with which he can perform all preliminary actions in order parking and picking operations.<br>
							On it <b>client</b> can see <em>SLOTNUM</em> and <em>TOKENID</em> received from parking system. Using it <b>client</b> can also enter his <em>TOKENID</em>
							in order to start picking operations.
						</p>							
						</td>
						<td><center>
							<ks>ManagerGUI: </ks>
						</center>
						<center> <a href="https://github.com/P-damicis/Automated_Car_Parking/tree/main/sprint_4/ParkManagerGui">ParkManagerGUI: </a></center><br>
						<p>
							It's the graphic interface at ParkingManager's disposal. Using it He can monitor many values about <b>parking</b> and <b>trolley</b> status.<br>
							On thi GUI there are also two buttons to STOP and RESUME, when necessary, <b>trolley</b> operations.
							
						</p>
						</td>
					</tr>
					<tr>
						<td colspan="2">
							<center><img width="80%" src="img/logicalArchitecture.png"></center>
						</td>
					</tr>
					
				</table>
			</p>
			
		</div>
		<h2>Test plans</h2>
				<p>
					During this final SPRINT, it will be necessary perform also <k>distributed-tests</k>, in order to check the correct functioning of some
					remote components like <b>clientGUI</b>, <b>managerGUI</b> and <b>sonar</b>. 
				</p>
			<kc>TestPlans goals:</kc>
			<div class="remark">
				
			<ul>
				<li>Ensure that new components work properly individually. <k><b>(unit testing)</b></k> <br>
					<div class=remark2>
						<h3>Real Sonar and related components</h3>
						<p>
							We want to test if real sonar, into <tt>ctxSonaronrasp</tt> context, works properly sending to system the measured data.<br>
							Those data have to be received by a specific QAktor <b>sonarhandler</b>, which handles them setting the status of <em>OUTDOOR area</em> and
							triggering/stopping the countdown performed by <b>outdoortimer</b>.  
						</p>
					</div>
					<div class=remark2>
						<h3>Client GUI</h3>
						<p>
							This test consists of checking if the <b>clientGUI</b> exchange messages with <b>parkingmanagerserive</b> correctly.
						</p>
					</div>
					<div class=remark2>
						<h3>ManagerGUI</h3>
						<p>
							We wanto to check if all target informations about parking system and trolley are correctly updated by <b>managerGUI</b> and if 
							<k>STOP/RESUME</k> buttons on it work properly.  
						</p>
					</div>
					
					
				<li>Ensure that the workflow of the system meets a set of requirements <k><b>(integration testing)</b>
					</k>. <br> <br>

					<div class=remark2>
						<h3>Workflow</h3>
						During this test, it's verified the correct behaviour of the system.<br>
						In particular, it will be runned the entire system, including distributed components, and it will be checked if the system it's able
						to perform all parking and picking operations in the correct way.
					</div>
			</ul>
			</div>

		<h2>Project</h2>

		<h2>Testing</h2>
			Tests is built using CoapObserver provided by the costumer in the project <ks>it.unibo.qak21.basicrobot
				</ks> (<a
					href="../test/it/unibo/parkingmanagerservice/test/utils/CoapObserverForTesting.kt">CoapObserverForTesting.kt</a>).
				<br>
				In this SPRINT we have added only the <k>Trolley</k> compared to the previous SPRINT, so for the correct
				functioning of the <b>parkingmanagerservice</b> the tests done in the
				previous sprint are sufficient.
				In this phase, the tests will be limited to verify the correct functioning of the <k>Trolley</k> in
				different situations. <br>
				In order to observe trolley movements, we will use the virtual enviroment provided by costumer. To start
				this eviroments, it's necessary launch a <i>.yaml</i> file with <b>Docker</b>,
				in particular running:
				<pre> docker-compose -f basicrobotVirtual.yaml up </pre>
			</p>
		
		<h2>Deployment</h2>
		The deployment of SPRINT 4 consists in a release on a <a
			href="https://github.com/P-damicis/Automated_Car_Parking/tree/main/sprint_3">Github repository</a>.

		<h2>Maintenance</h2>
		This is the fourth and final SPRINT!!!!!!!!!!!!!!
		<br /><br />
	</div>

	<div style="background-color:rgba(42, 7, 241, 1.0); width:100%;text-align:center;color:white">
		<table style="width:100%" border="1">
			<tr>
				By Mantovani Leonardo and Pier Domenico d'Amicis

			</tr>
		</table>
	</div>
</body>

</html>
